generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserStatus {
  Enable
  Disable
}

enum Status {
  Enable
  Disable
}

model User {
  userId           String     @id @default(cuid())
  userFirstName    String
  userLastName     String
  userEmail        String     @unique
  userPassword     String
  userRoleId       String
  userDepartmentId String
  userStatus       UserStatus @default(Enable)
  userCreateBy     String
  userCreateAt     DateTime
  userUpdateBy     String?
  userUpdateAt     DateTime?

  createdBy    User?  @relation("UserCreatedBy", fields: [userCreateBy], references: [userId])
  createdUsers User[] @relation("UserCreatedBy")

  updatedBy    User?  @relation("UserUpdatedBy", fields: [userUpdateBy], references: [userId])
  updatedUsers User[] @relation("UserUpdatedBy")

  role       Role       @relation(fields: [userRoleId], references: [roleId])
  department Department @relation(fields: [userDepartmentId], references: [departmentId])

  rolesCreated Role[] @relation("RoleCreatedBy")
  rolesUpdated Role[] @relation("RoleUpdatedBy")

  departmentsCreated Department[] @relation("DepartmentCreatedBy")
  departmentsUpdated Department[] @relation("DepartmentUpdatedBy")

  @@index([userCreateBy])
  @@index([userUpdateBy])
}

model Department {
  departmentId       String    @id @default(cuid())
  departmentName     String
  departmentRoleId   String
  departmentCreateBy String
  departmentCreateAt DateTime
  departmentUpdateBy String?
  departmentUpdateAt DateTime?

  users User[]

  createdBy User? @relation("DepartmentCreatedBy", fields: [departmentCreateBy], references: [userId])
  updatedBy User? @relation("DepartmentUpdatedBy", fields: [departmentUpdateBy], references: [userId])

  @@index([departmentCreateBy])
  @@index([departmentUpdateBy])
}

model Role {
  roleId       String    @id @default(cuid())
  roleName     String
  roleCreateBy String
  roleCreateAt DateTime
  roleUpdateBy String?
  roleUpdateAt DateTime?

  users User[]

  createdBy User? @relation("RoleCreatedBy", fields: [roleCreateBy], references: [userId])
  updatedBy User? @relation("RoleUpdatedBy", fields: [roleUpdateBy], references: [userId])

  @@index([roleCreateBy])
  @@index([roleUpdateBy])
}
